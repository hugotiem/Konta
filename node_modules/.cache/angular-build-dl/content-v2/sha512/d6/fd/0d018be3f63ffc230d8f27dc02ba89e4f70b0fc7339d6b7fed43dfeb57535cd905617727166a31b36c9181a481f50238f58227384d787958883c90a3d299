{"version":3,"sources":["webpack:///src/app/tab2/tab2.page.html","webpack:///src/app/tab2/tab2-routing.module.ts","webpack:///src/app/tab2/tab2.module.ts","webpack:///src/app/tab2/tab2.page.scss","webpack:///src/app/tab2/tab2.page.ts"],"names":["routes","path","component","loadChildren","then","m","EditPageModule","Tab2PageRoutingModule","imports","forChild","exports","Tab2PageModule","declarations","Tab2Page","router","routerOutlet","app","afDB","popoverController","modalController","navCtrl","items","getItemsFromFirebase","event","setTimeout","target","complete","ev","create","popover","present","componentProps","cssClass","translucent","item","navData","queryParams","navigateForward","afBD","swipeToClose","presentingElement","nativeEl","modal","list","snapshotChanges","subscribe","actions","forEach","action","payload","exportVal","push","key","name","category","price","firstPrice","stock","formule","formuleContent","disponible","Object","keys","i","cpt","j","k","title","quantite","length","remove","selector","template"],"mappings":"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","file":"tab2-tab2-module-es5.js","sourcesContent":["export default \"<ion-header mode=\\\"ios\\\" >\\n  <ion-toolbar >\\n    <ion-title>Items</ion-title>\\n    <ion-button class=\\\"toolbar-button\\\" fill=\\\"clear\\\" slot=\\\"end\\\" (click)=\\\"presentPopover($event)\\\">\\n      <ion-icon name=\\\"chevron-down\\\"></ion-icon>\\n    </ion-button>\\n    <ion-button class=\\\"toolbar-button\\\" fill=\\\"clear\\\" slot=\\\"end\\\" (click)=\\\"presentAddModal()\\\">\\n      <ion-icon name=\\\"add\\\"></ion-icon>\\n    </ion-button>\\n    <ion-button  class=\\\"toolbar-button\\\" slot=\\\"end\\\" fill=\\\"clear\\\" (click)=\\\"optionsPopover($event)\\\">\\n      <ion-icon name=\\\"ellipsis-vertical\\\"></ion-icon>\\n    </ion-button>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\n  <ion-refresher slot=\\\"fixed\\\" (ionRefresh)=\\\"doRefresh($event)\\\">\\n    <ion-refresher-content></ion-refresher-content>\\n  </ion-refresher>\\n\\n  <ion-list lines=\\\"full\\\">\\n\\n    <ion-item class=\\\"title\\\">\\n      <ion-title size=\\\"large\\\">Produits</ion-title>\\n    </ion-item>\\n\\n    <ion-item-sliding *ngFor=\\\"let item of items; let i = index\\\">\\n      <ion-item *ngIf=\\\"!item.formule\\\" (click)=\\\"goToEdit(item)\\\" button style=\\\"--padding-top: 5px\\\">\\n        <ion-thumbnail>\\n          <img src=\\\"https://gravatar.com/avatar/dba6bae8c566f9d4041fb9cd9ada7741?d=identicon&f=y\\\">\\n        </ion-thumbnail>\\n        <div>\\n          <ion-label style=\\\"font-weight: bold;\\\"> {{ item.name }} </ion-label>\\n          <ion-label style=\\\"font-size: medium;\\\"> {{ item.category }} </ion-label>\\n          <ion-note> {{ item.price }} €</ion-note>\\n        </div>\\n        <ion-chip slot=\\\"end\\\" *ngIf='item.stock == 0' color=\\\"danger\\\">\\n          <ion-label> {{ item.stock }} </ion-label>\\n        </ion-chip>\\n        <ion-chip slot=\\\"end\\\" *ngIf='item.stock != 0'>\\n          <ion-label> {{ item.stock }} </ion-label>\\n        </ion-chip>\\n\\n      </ion-item>\\n\\n      <ion-item-options side=\\\"end\\\">\\n        <ion-item-option (click)=\\\"delete(item)\\\" color=\\\"danger\\\">\\n          <ion-icon name=\\\"trash\\\" slot=\\\"icon-only\\\"></ion-icon>\\n        </ion-item-option>\\n      </ion-item-options>\\n    </ion-item-sliding>\\n\\n    <ion-item class=\\\"title\\\">\\n      <ion-title size=\\\"large\\\">Formules</ion-title>\\n    </ion-item>\\n\\n    <ion-item-sliding *ngFor=\\\"let item of items; let i = index\\\">\\n      <ion-item [disabled]=\\\"!item.disponible\\\" *ngIf=\\\"item.formule\\\" (click)=\\\"goToEdit(item)\\\" button style=\\\"--padding-top: 5px\\\">\\n        <ion-thumbnail>\\n          <img src=\\\"https://gravatar.com/avatar/dba6bae8c566f9d4041fb9cd9ada7741?d=identicon&f=y\\\">\\n        </ion-thumbnail>\\n        <div>\\n          <ion-label style=\\\"font-weight: bold;\\\"> {{ item.name }} </ion-label>\\n          <ion-label style=\\\"font-size: medium;\\\"> {{ item.category }} </ion-label>\\n          <ion-note> {{ item.price }} €</ion-note>\\n        </div>\\n\\n        <ion-note slot=\\\"end\\\" style=\\\"text-align: end;\\\" *ngIf=\\\"item.disponible\\\">Disponible</ion-note>\\n        <ion-note slot=\\\"end\\\" style=\\\"text-align: end;\\\" *ngIf=\\\"!item.disponible\\\" color=\\\"danger\\\">Indisponible</ion-note>\\n\\n      </ion-item>\\n\\n      <ion-item-options side=\\\"end\\\">\\n        <ion-item-option (click)=\\\"delete(item)\\\" color=\\\"danger\\\">\\n          <ion-icon name=\\\"trash\\\" slot=\\\"icon-only\\\"></ion-icon>\\n        </ion-item-option>\\n      </ion-item-options>\\n    </ion-item-sliding>\\n\\n  </ion-list>\\n\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { Tab2Page } from './tab2.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: Tab2Page,\n  },\n  {\n    path: 'edit',\n    loadChildren: () => import('./edit/edit.module').then( m => m.EditPageModule)\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class Tab2PageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Tab2Page } from './tab2.page';\nimport { ExploreContainerComponentModule } from '../explore-container/explore-container.module';\n\nimport { Tab2PageRoutingModule } from './tab2-routing.module';\n\nimport { AddComponent } from './add/add.component';\nimport { QuantiteComponent } from './add/quantite/quantite.component';\nimport { OptionsComponent } from './add/options/options.component';\nimport { ProduitsListComponent } from './add/produits-list/produits-list.component';\n\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    ExploreContainerComponentModule,\n    Tab2PageRoutingModule\n  ],\n  declarations: [Tab2Page, QuantiteComponent, OptionsComponent, ProduitsListComponent]\n})\nexport class Tab2PageModule {}\n","export default \"/****    HEADER    ****/\\n/****    CONTENT ****/\\n.title {\\n  margin-top: 20px;\\n}\\n.title ion-title {\\n  padding-left: 0;\\n}\\nion-thumbnail {\\n  margin-right: 10px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdGFiMi90YWIyLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSx1QkFBQTtBQUVBLHFCQUFBO0FBRUE7RUFDSSxnQkFBQTtBQURKO0FBR0k7RUFDSSxlQUFBO0FBRFI7QUFLQTtFQUNJLGtCQUFBO0FBRkoiLCJmaWxlIjoic3JjL2FwcC90YWIyL3RhYjIucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKiogICAgSEVBREVSICAgICoqKiovXHJcblxyXG4vKioqKiAgICBDT05URU5UICoqKiovXHJcblxyXG4udGl0bGUge1xyXG4gICAgbWFyZ2luLXRvcDogMjBweDtcclxuXHJcbiAgICBpb24tdGl0bGV7XHJcbiAgICAgICAgcGFkZGluZy1sZWZ0OiAwO1xyXG4gICAgfVxyXG59XHJcblxyXG5pb24tdGh1bWJuYWlsIHtcclxuICAgIG1hcmdpbi1yaWdodDogMTBweDtcclxufSJdfQ== */\";","import { Component } from '@angular/core';\nimport { NavigationExtras, Router } from '@angular/router';\nimport { AngularFireDatabase } from '@angular/fire/database';\nimport { HttpClient } from '@angular/common/http';\n\n// COMPONENTS FROM IONIC\nimport { PopoverController } from '@ionic/angular';\nimport { ModalController } from '@ionic/angular';\nimport { IonRouterOutlet } from '@ionic/angular';\nimport { NavController } from '@ionic/angular';\n\n// OWN COMPONENTS\nimport { PopoverComponent } from './popover/popover.component';\nimport { AddComponent } from './add/add.component';\n\n// CLASS FROM PROJECT\nimport { AppComponent } from '../app.component';\nimport { ItemsComponent } from '../tab3/new/items/items.component';\nimport { OptionsPopoverComponent } from '../options-popover/options-popover.component';\n\n@Component({\n  selector: 'app-tab2',\n  templateUrl: 'tab2.page.html',\n  styleUrls: ['tab2.page.scss']\n})\nexport class Tab2Page {\n\n  public items: any = []\n\n  constructor(\n    private router: Router, \n    private routerOutlet: IonRouterOutlet,\n    private app: AppComponent,\n    public afDB: AngularFireDatabase, \n    private popoverController: PopoverController, \n    private modalController: ModalController,\n    private navCtrl: NavController) {\n\n    //this.items = this.app.items;\n    this.getItemsFromFirebase();\n\n  }\n\n  doRefresh(event) {\n    setTimeout(() => {\n      event.target.complete();\n    }, 1000);\n  }\n\n  async optionsPopover(ev: any) {\n    const popover = await this.popoverController.create({\n      component: OptionsPopoverComponent,\n      event: ev\n    })\n\n    return await popover.present();\n  }\n\n  async presentPopover(ev: any) {\n    const popover = await this.popoverController.create({\n      component: PopoverComponent,\n      componentProps: {\n        \n      },\n      cssClass: 'sort-popover',\n      event: ev,\n      translucent: true\n    });\n    return await popover.present();\n  }\n\n  async goToEdit(item: any) {\n    let navData: NavigationExtras = {\n      queryParams: {\n        item: item,\n        afDB: this.afDB\n      }\n    }\n    this.navCtrl.navigateForward('tabs/tab2/edit', navData);\n  }\n\n  async presentAddModal() {\n    const modal = await this.modalController.create({\n      component: AddComponent,\n      componentProps: {\n        afBD: this.afDB\n      },\n      cssClass: '', \n      swipeToClose: true,\n      presentingElement: this.routerOutlet.nativeEl\n    });\n    return await  modal.present();\n  }\n\n  getItemsFromFirebase(){ \n    this.afDB.list('produits/').snapshotChanges(['child_added', 'child_removed', 'child_changed']).subscribe(actions => {\n      this.items = [];\n      \n      actions.forEach(action => {\n\n        let item = action.payload.exportVal();\n        this.items.push({\n          key: action.key,\n          name: item.name,\n          category: item.category,\n          price: item.price,\n          firstPrice: item.firstPrice,\n          stock: item.stock,\n          formule: item.formule,\n          formuleContent: item.formuleContent,\n          disponible: item.disponible\n        })\n      })\n\n      for(let i of Object.keys(this.items)){\n        if(this.items[i].formule){\n          let cpt: number = 0;\n          for(let j of Object.keys(this.items[i].formuleContent)){\n            for(let k of Object.keys(this.items)){\n              if(this.items[i].formuleContent[j].title == this.items[k].name && !this.items[k].formule){    \n                if(this.items[k].stock - this.items[i].formuleContent[j].quantite < 0){\n                  this.items[i].disponible = false;\n                }\n                else {\n                  cpt = cpt + 1;\n                  if(this.items[i].formuleContent.length == cpt){\n                    this.items[i].disponible = true;\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    })\n  }\n\n  delete(item: any) {\n    this.afDB.list('produits/').remove(item.key);\n  }\n\n}\n"]}