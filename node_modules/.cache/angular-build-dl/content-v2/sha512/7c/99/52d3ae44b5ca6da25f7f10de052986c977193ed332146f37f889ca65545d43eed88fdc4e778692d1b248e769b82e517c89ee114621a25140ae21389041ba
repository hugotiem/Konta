!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{xhSr:function(i,n,o){"use strict";o.r(n),o.d(n,"EditPageModule",(function(){return k}));var r=o("ofXK"),s=o("3Pt+"),a=o("TEn/"),c=o("tyNb"),l=o("mrSG"),b=o("9ybx"),u=o("fXoL"),m=o("sSZD");function d(e,t){if(1&e&&(u.Lb(0,"ion-item",10),u.Lb(1,"ion-label"),u.ic(2,"Nom du client :"),u.Kb(),u.Lb(3,"ion-note",11),u.ic(4),u.Kb(),u.Kb()),2&e){var i=u.Vb();u.yb(4),u.kc(" ",i.item.clientName," ")}}var h,f,p,y=[{path:"",component:(h=function(){function i(t,n,o,r){var s=this;e(this,i),this.navCtrl=t,this.modalController=n,this.afDB=o,this.route=r,this.item=[],this.produits=[],this.details="",this.route.queryParams.subscribe((function(e){s.key=e.item.key}))}var n,o,r;return n=i,(o=[{key:"ngOnInit",value:function(){this.getDeliveryFromFirebase(),this.getProduitsFromFirebase()}},{key:"goBack",value:function(){this.navCtrl.navigateBack("tabs/tab3")}},{key:"getType",value:function(e){return"lone"==e?"Livraison seule":"Livraison partag\xe9e"}},{key:"addNewExpModal",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:b.a,componentProps:{afDB:this.afDB,key:this.key,delivery:this.item.order,title:this.item.title,price:this.item.price,date:this.item.date,km:this.item.distance,type:this.item.type,clientName:this.item.clientName},cssClass:"my-custom-class"});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"setQuantite",value:function(e,t){for(var i=0,n=Object.keys(this.produits);i<n.length;i++){var o=n[i];this.produits[o].key==e&&(this.produits[o].content.stock=this.produits[o].content.stock+t,this.afDB.object("produits/"+e+"/stock").set(this.produits[o].content.stock))}}},{key:"delete",value:function(){for(var e=0,t=Object.keys(this.item.order);e<t.length;e++)for(var i=t[e],n=0,o=Object.keys(this.item.order[i].items);n<o.length;n++){var r=o[n];if(null!=this.item.order[i].items[r].formuleContent){if(0!=this.item.order[i].items[r].formuleContent.length)for(var s=0,a=Object.keys(this.item.order[i].items[r].formuleContent);s<a.length;s++){var c=a[s];this.setQuantite(this.item.order[i].items[r].formuleContent[c].key,this.item.order[i].items[r].formuleContent[c].quantite)}}else""!=this.item.order[i].items[r].key&&this.setQuantite(this.item.order[i].items[r].key,this.item.order[i].items[r].quantite)}this.afDB.list("Livraisons/").remove(this.key),this.goBack()}},{key:"getDeliveryFromFirebase",value:function(){var e=this;this.afDB.object("Livraisons/"+this.key).valueChanges().subscribe((function(t){e.item=t}))}},{key:"getProduitsFromFirebase",value:function(){var e=this;this.afDB.list("produits").snapshotChanges(["child_added","child_removed","child_changed"]).subscribe((function(t){e.produits=[],e.details="",t.forEach((function(t){e.produits.push({key:t.key,content:t.payload.exportVal()})}));for(var i=0,n=Object.keys(e.item.order);i<n.length;i++)for(var o=n[i],r=0,s=Object.keys(e.item.order[o].items);r<s.length;r++){var a=s[r];e.details=e.item.order[o]==e.item.order[0]&&e.item.order[o].items[a]==e.item.order[0].items[0]?e.item.order[o].items[a].quantite+" x "+e.item.order[o].items[a].title:e.details+", "+e.item.order[o].items[a].quantite+" x "+e.item.order[o].items[a].title}}))}}])&&t(n.prototype,o),r&&t(n,r),i}(),h.\u0275fac=function(e){return new(e||h)(u.Ib(a.X),u.Ib(a.W),u.Ib(m.a),u.Ib(c.a))},h.\u0275cmp=u.Cb({type:h,selectors:[["app-edit"]],decls:43,vars:8,consts:[[1,"ion-no-border"],[2,"--border-style","none"],["slot","start","fill","clear",2,"--padding-start","0",3,"click"],["size","large","name","chevron-back"],["slot","end","fill","clear",3,"click"],["lines","none"],[2,"text-align","center"],[2,"font-size","20pt","font-weight","bold"],[2,"--padding-end","0"],["slot","end","readonly","","displayFormat","MM/DD/YYYY",2,"text-align","end",3,"value"],["lines","full"],["slot","end",2,"text-align","right"],["lines","full",4,"ngIf"],["lines","full","fill","clear","expand","full",3,"click"],["color","danger"]],template:function(e,t){1&e&&(u.Lb(0,"ion-header",0),u.Lb(1,"ion-toolbar",1),u.Lb(2,"ion-button",2),u.Tb("click",(function(){return t.goBack()})),u.Jb(3,"ion-icon",3),u.Kb(),u.Lb(4,"ion-button",4),u.Tb("click",(function(){return t.addNewExpModal()})),u.Lb(5,"ion-label"),u.ic(6,"Edit"),u.Kb(),u.Kb(),u.Kb(),u.Lb(7,"ion-list",5),u.Lb(8,"ion-item",6),u.Lb(9,"ion-label",7),u.ic(10),u.Kb(),u.Kb(),u.Lb(11,"ion-item"),u.Lb(12,"ion-title"),u.ic(13),u.Kb(),u.Kb(),u.Lb(14,"ion-item",8),u.Lb(15,"ion-label"),u.ic(16,"Livr\xe9 par "),u.Lb(17,"strong"),u.ic(18),u.Kb(),u.Kb(),u.Jb(19,"ion-datetime",9),u.Kb(),u.Jb(20,"ion-item-divider",10),u.Lb(21,"ion-item",10),u.Lb(22,"ion-label"),u.ic(23,"D\xe9tail :"),u.Kb(),u.Lb(24,"ion-note",11),u.ic(25),u.Kb(),u.Kb(),u.Lb(26,"ion-item",10),u.Lb(27,"ion-label"),u.ic(28,"Distance :"),u.Kb(),u.Lb(29,"ion-note",11),u.ic(30),u.Kb(),u.Kb(),u.hc(31,d,5,1,"ion-item",12),u.Lb(32,"ion-item"),u.Lb(33,"ion-label"),u.ic(34,"Type de livraison :"),u.Kb(),u.Lb(35,"ion-note",11),u.ic(36),u.Kb(),u.Kb(),u.Jb(37,"ion-item-divider"),u.Lb(38,"section"),u.Lb(39,"ion-button",13),u.Tb("click",(function(){return t.delete()})),u.Lb(40,"ion-label",14),u.ic(41,"Supprimer item"),u.Kb(),u.Kb(),u.Kb(),u.Kb(),u.Kb(),u.Jb(42,"ion-content")),2&e&&(u.yb(10),u.kc(" ",t.item.title," "),u.yb(3),u.kc("\u20ac",(t.item.price-0).toFixed(2)," "),u.yb(5),u.jc(t.item.name),u.yb(1),u.Zb("value",t.item.date),u.yb(6),u.kc(" ",t.details," "),u.yb(5),u.kc(" ",t.item.distance," km "),u.yb(1),u.Yb("ngIf","prodOnly"!=t.item.type),u.yb(5),u.kc(" ",t.getType(t.item.type)," "))},directives:[a.q,a.T,a.e,a.r,a.z,a.A,a.t,a.R,a.m,a.cb,a.u,a.C,r.i,a.l],styles:["ion-item.ion-activated[_ngcontent-%COMP%]{--background-activated:none}"]}),h)}],v=((p=function t(){e(this,t)}).\u0275mod=u.Gb({type:p}),p.\u0275inj=u.Fb({factory:function(e){return new(e||p)},imports:[[c.i.forChild(y)],c.i]}),p),k=((f=function t(){e(this,t)}).\u0275mod=u.Gb({type:f}),f.\u0275inj=u.Fb({factory:function(e){return new(e||f)},imports:[[r.b,s.a,a.U,v]]}),f)}}])}();