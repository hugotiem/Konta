!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"9ybx":function(t,i,o){"use strict";o.d(i,"a",(function(){return _}));var r=o("mrSG"),a=o("fXoL"),s=o("TEn/"),c=o("ofXK");function l(e,t){if(1&e){var n=a.Mb();a.Lb(0,"ion-item",6),a.Tb("click",(function(){a.ec(n);var e=a.Vb().$implicit;return a.Vb().close(e)})),a.Lb(1,"ion-label"),a.ic(2),a.Kb(),a.Kb()}if(2&e){var i=a.Vb().$implicit;a.Yb("disabled",0==i.quantite),a.yb(2),a.kc(" ",i.title," ")}}function b(e,t){if(1&e&&(a.Lb(0,"ion-item-group"),a.hc(1,l,3,2,"ion-item",5),a.Kb()),2&e){var n=t.$implicit;a.yb(1),a.Yb("ngIf",!n.formule)}}function u(e,t){if(1&e){var n=a.Mb();a.Lb(0,"ion-item",6),a.Tb("click",(function(){a.ec(n);var e=a.Vb().$implicit;return a.Vb().close(e)})),a.Lb(1,"ion-label"),a.ic(2),a.Kb(),a.Kb()}if(2&e){var i=a.Vb().$implicit;a.Yb("disabled",!i.disponible),a.yb(2),a.kc(" ",i.title," ")}}function d(e,t){if(1&e&&(a.Lb(0,"ion-item-group"),a.hc(1,u,3,2,"ion-item",5),a.Kb()),2&e){var n=t.$implicit;a.yb(1),a.Yb("ngIf",n.formule)}}var m,p=((m=function(){function t(n){e(this,t),this.modalctrl=n,this.items=[]}return n(t,[{key:"ngOnInit",value:function(){this.getTitleInFirebase()}},{key:"close",value:function(e){var t=this;setTimeout((function(){null!==e?t.modalctrl.dismiss({item:e}):t.modalctrl.dismiss()}),200)}},{key:"getTitleInFirebase",value:function(){var e=this;this.afDB.list("produits/").snapshotChanges(["child_added","child_removed","child_changed"]).subscribe((function(t){e.items=[],t.forEach((function(t){e.items.push({title:t.payload.exportVal().name,price:t.payload.exportVal().price,firstPrice:t.payload.exportVal().firstPrice,quantite:t.payload.exportVal().stock,key:t.key,formule:t.payload.exportVal().formule,formuleContent:t.payload.exportVal().formuleContent,disponible:t.payload.exportVal().disponible})}));for(var n=0,i=Object.keys(e.items);n<i.length;n++){var o=i[n];if(e.items[o].formule)for(var r=0,a=0,s=Object.keys(e.items[o].formuleContent);a<s.length;a++)for(var c=s[a],l=0,b=Object.keys(e.items);l<b.length;l++){var u=b[l];e.items[o].formuleContent[c].title!=e.items[u].title||e.items[u].formule||(e.items[u].quantite-e.items[o].formuleContent[c].quantite<0?e.items[o].disponible=!1:(r+=1,e.items[o].formuleContent.length==r&&(e.items[o].disponible=!0)))}}}))}}]),t}()).\u0275fac=function(e){return new(e||m)(a.Ib(s.W))},m.\u0275cmp=a.Cb({type:m,selectors:[["app-items"]],inputs:{afDB:"afDB"},decls:18,vars:2,consts:[[2,"position","fixed"],["fill","clear","slot","start",3,"click"],["disabled","","animated","","showCancelButton","focus"],[2,"margin-top","150px"],[4,"ngFor","ngForOf"],["button","","detail","false",3,"disabled","click",4,"ngIf"],["button","","detail","false",3,"disabled","click"]],template:function(e,t){1&e&&(a.Lb(0,"ion-header",0),a.Lb(1,"ion-toolbar"),a.Lb(2,"ion-button",1),a.Tb("click",(function(){return t.close(null)})),a.Lb(3,"ion-label"),a.ic(4,"Cancel"),a.Kb(),a.Kb(),a.Lb(5,"ion-title"),a.ic(6,"Selectionner produit"),a.Kb(),a.Kb(),a.Lb(7,"ion-toolbar"),a.Jb(8,"ion-searchbar",2),a.Kb(),a.Kb(),a.Lb(9,"ion-list",3),a.Lb(10,"ion-list-header"),a.Lb(11,"ion-title"),a.ic(12,"Produits"),a.Kb(),a.Kb(),a.hc(13,b,2,1,"ion-item-group",4),a.Lb(14,"ion-list-header"),a.Lb(15,"ion-title"),a.ic(16,"Formules"),a.Kb(),a.Kb(),a.hc(17,d,2,1,"ion-item-group",4),a.Kb()),2&e&&(a.yb(13),a.Yb("ngForOf",t.items),a.yb(4),a.Yb("ngForOf",t.items))},directives:[s.q,s.T,s.e,s.z,s.R,s.J,s.db,s.A,s.B,c.h,s.v,c.i,s.t],styles:[""]}),m);function f(e,t){if(1&e){var n=a.Mb();a.Lb(0,"ion-item",2),a.Tb("click",(function(){a.ec(n);var e=t.$implicit;return a.Vb().dissmis(e)})),a.Lb(1,"ion-label"),a.ic(2),a.Kb(),a.Kb()}if(2&e){var i=t.$implicit;a.yb(2),a.kc(" ",i," ")}}var h,g,v=((g=function(){function t(n){e(this,t),this.popoverCtrl=n,this.names=["Alexis","Hugo","Marvyn","Gud","Taheir"]}return n(t,[{key:"ngOnInit",value:function(){}},{key:"dissmis",value:function(e){this.popoverCtrl.dismiss({fromPopover:e})}}]),t}()).\u0275fac=function(e){return new(e||g)(a.Ib(s.ab))},g.\u0275cmp=a.Cb({type:g,selectors:[["app-names"]],decls:2,vars:1,consts:[["mode","ios","lines","none"],["button","","detail","false",3,"click",4,"ngFor","ngForOf"],["button","","detail","false",3,"click"]],template:function(e,t){1&e&&(a.Lb(0,"ion-list",0),a.hc(1,f,3,1,"ion-item",1),a.Kb()),2&e&&(a.yb(1),a.Yb("ngForOf",t.names))},directives:[s.A,c.h,s.t,s.z],styles:[""]}),g),y=((h=function(){function t(n){e(this,t),this.popoverCtrl=n}return n(t,[{key:"ngOnInit",value:function(){}},{key:"lone",value:function(){this.close("lone")}},{key:"share",value:function(){this.close("share")}},{key:"close",value:function(e){this.popoverCtrl.dismiss({type:e})}}]),t}()).\u0275fac=function(e){return new(e||h)(a.Ib(s.ab))},h.\u0275cmp=a.Cb({type:h,selectors:[["app-options-livraison"]],decls:7,vars:0,consts:[["lines","none"],["button","",3,"click"]],template:function(e,t){1&e&&(a.Lb(0,"ion-list",0),a.Lb(1,"ion-item",1),a.Tb("click",(function(){return t.lone()})),a.Lb(2,"ion-label"),a.ic(3,"Livraison seule"),a.Kb(),a.Kb(),a.Lb(4,"ion-item",1),a.Tb("click",(function(){return t.share()})),a.Lb(5,"ion-label"),a.ic(6,"Livraison partag\xe9e"),a.Kb(),a.Kb(),a.Kb())},directives:[s.A,s.t,s.z],styles:[""]}),h),k=o("sSZD"),C=o("3Pt+");function L(e,t){if(1&e&&(a.Lb(0,"ion-label"),a.ic(1),a.Kb()),2&e){var n=a.Vb().$implicit;a.yb(1),a.kc(" ",n.name," ")}}function K(e,t){1&e&&(a.Lb(0,"ion-note"),a.ic(1,"Nom du Livreur"),a.Kb())}function P(e,t){if(1&e){var n=a.Mb();a.Lb(0,"ion-item-sliding",null,27),a.Lb(2,"ion-item",28),a.Lb(3,"ion-input",29),a.Tb("ngModelChange",(function(e){return a.ec(n),t.$implicit.title=e})),a.Kb(),a.Jb(4,"span",30),a.Lb(5,"ion-button",31),a.Tb("click",(function(){a.ec(n);var e=t.$implicit,i=a.Vb().$implicit;return a.Vb().itemsModal(i,e)})),a.Jb(6,"ion-icon",32),a.Kb(),a.Kb(),a.Lb(7,"ion-item-options",33),a.Tb("click",(function(){a.ec(n);var e=t.$implicit,i=t.index,o=a.Vb().index;return a.Vb().delete(e,o,i)})),a.Lb(8,"ion-item-option",34),a.Jb(9,"ion-icon",35),a.Kb(),a.Kb(),a.Lb(10,"ion-item",36),a.Lb(11,"ion-label"),a.ic(12,"Quantit\xe9 :"),a.Kb(),a.Jb(13,"span",30),a.Lb(14,"div",37),a.Lb(15,"ion-chip",38),a.Tb("click",(function(){a.ec(n);var e=t.$implicit,i=a.Vb().$implicit;return a.Vb().remove(e,i)})),a.Jb(16,"ion-icon",39),a.Kb(),a.Lb(17,"ion-label",40),a.ic(18),a.Kb(),a.Lb(19,"ion-chip",41),a.Tb("click",(function(){a.ec(n);var e=t.$implicit,i=a.Vb().$implicit;return a.Vb().add(e,i)})),a.Jb(20,"ion-icon",42),a.Kb(),a.Kb(),a.Kb(),a.Kb()}if(2&e){var i=t.$implicit,o=t.index,r=a.Vb().index;a.yb(2),a.bc("id","formule-",r,"",o,"-item"),a.yb(1),a.ac("placeholder","Item ",o+1," :"),a.Yb("ngModel",i.title)("value",i.title),a.yb(7),a.ac("id","qte-",r,"-item"),a.yb(8),a.kc(" ",i.quantite," ")}}function M(e,t){if(1&e){var n=a.Mb();a.Lb(0,"ion-list"),a.Lb(1,"ion-item",23),a.Tb("click",(function(e){a.ec(n);var i=t.index;return a.Vb().namesPopover(e,i)})),a.hc(2,L,2,1,"ion-label",13),a.hc(3,K,2,0,"ion-note",13),a.Jb(4,"span",11),a.Jb(5,"ion-icon",22),a.Kb(),a.hc(6,P,21,7,"ion-item-sliding",12),a.Lb(7,"ion-item"),a.Lb(8,"ion-chip",24),a.Tb("click",(function(){a.ec(n);var e=t.$implicit;return a.Vb().addItems(e.items)})),a.Jb(9,"ion-icon",25),a.Lb(10,"ion-label"),a.ic(11,"Ajouter item"),a.Kb(),a.Kb(),a.Kb(),a.Lb(12,"ion-item",14),a.Lb(13,"ion-input",26),a.Tb("ngModelChange",(function(e){return a.ec(n),t.$implicit.firstPrice=e})),a.Kb(),a.Lb(14,"ion-label"),a.ic(15,"EUR"),a.Kb(),a.Jb(16,"span",11),a.Kb(),a.Kb()}if(2&e){var i=t.$implicit,o=t.index;a.yb(1),a.ac("id","no-input-",o,""),a.yb(1),a.Yb("ngIf",""!=i.name),a.yb(1),a.Yb("ngIf",""==i.name),a.yb(3),a.Yb("ngForOf",i.items),a.yb(7),a.Yb("ngModel",i.firstPrice)("value",i.firstPrice)}}function O(e,t){if(1&e){var n=a.Mb();a.Lb(0,"ion-item"),a.Lb(1,"ion-chip",24),a.Tb("click",(function(){return a.ec(n),a.Vb().addAdmin()})),a.Jb(2,"ion-icon",25),a.Lb(3,"ion-label"),a.ic(4,"Ajouter livreur"),a.Kb(),a.Kb(),a.Kb()}}var x,_=((x=function(){function t(n,i,o){e(this,t),this.modalCtrl=n,this.popoverCtrl=i,this.afDB=o,this.produits=[],this.tmp=[],null==this.date&&(this.date=(new Date).toISOString()),null==this.type&&(this.type="lone"),this.getProduitsFromFirebase()}return n(t,[{key:"ngOnInit",value:function(){if(null==this.delivery)this.init();else for(var e=0,t=Object.keys(this.delivery);e<t.length;e++)for(var n=t[e],i=0,o=Object.keys(this.delivery[n].items);i<o.length;i++){var r=o[i];if(null!=this.delivery[n].items[r].formuleContent){if(0!=this.delivery[n].items[r].formuleContent.length)for(var a=0,s=Object.keys(this.delivery[n].items[r].formuleContent);a<s.length;a++){var c=s[a];this.tmp.push({key:this.delivery[n].items[r].formuleContent[c].key,quantite:this.delivery[n].items[r].formuleContent[c].quantite})}}else null!=this.delivery[n].items[r].key&&this.tmp.push({key:this.delivery[n].items[r].key,quantite:this.delivery[n].items[r].quantite})}}},{key:"init",value:function(){this.delivery=[],this.addAdmin(),this.price=0}},{key:"addAdmin",value:function(){this.delivery.push({name:"",items:[],firstPrice:0,delivery:!0}),this.addItems(this.delivery[this.delivery.length-1].items)}},{key:"addItems",value:function(e){e.push({key:"",title:"",quantite:1,price:0,firstPrice:0,formuleContent:[],max:-1})}},{key:"close",value:function(){this.modalCtrl.dismiss()}},{key:"add",value:function(e,t){-1!=e.max?e.quantite<e.max&&(e.quantite++,this.updatePrices(e,1,!0),this.updatesFirstPrices(t,1,e,!0)):e.quantite++}},{key:"remove",value:function(e,t){e.quantite>1&&(e.quantite--,this.updatePrices(e,1,!1),this.updatesFirstPrices(t,1,e,!1))}},{key:"updatePrices",value:function(e,t,n){this.price=n?this.price+e.price:this.price-e.price*t}},{key:"updatesFirstPrices",value:function(e,t,n,i){e.firstPrice=i?e.firstPrice+n.firstPrice:e.firstPrice-n.firstPrice*t}},{key:"delete",value:function(e,t,n){var i=this.delivery[t];this.price=this.price-e.price*e.quantite,i.firstPrice=i.firstPrice-i.items[n].firstPrice*i.quantite,i.items.splice(n,1)}},{key:"deleteAll",value:function(e,t){for(var n=0,i=Object.keys(e.items);n<i.length;n++){var o=i[n];this.price=this.price-e.items[o].price*e.items[o].quantite,e.firstPrice=e.firstPrice-e.items[o].firstPrice*e.items[o].quantite}this.delivery.splice(t,1)}},{key:"itemsModal",value:function(e,t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=this.modalCtrl,n.t1=p,n.t2={afDB:this.afDB},n.t3=!0,n.next=6,this.modalCtrl.getTop();case 6:return n.t4=n.sent,n.t5={component:n.t1,componentProps:n.t2,cssClass:"my-custom-class",swipeToClose:n.t3,presentingElement:n.t4},n.next=10,n.t0.create.call(n.t0,n.t5);case 10:return(i=n.sent).onDidDismiss().then((function(n){void 0!==n.data&&(""!=t.title&&(o.updatePrices(t,t.quantite,!1),o.updatesFirstPrices(e,t.quantite,t,!1)),t.title=n.data.item.title,t.max=n.data.item.quantite,t.price=n.data.item.price,t.firstPrice=n.data.item.firstPrice,t.quantite=1,null!=n.data.item.formuleContent&&(t.formuleContent=n.data.item.formuleContent),t.key=n.data.item.key,o.updatePrices(t,1,!0),o.updatesFirstPrices(e,1,t,!0))})),n.next=14,i.present();case 14:return n.abrupt("return",n.sent);case 15:case"end":return n.stop()}}),n,this)})))}},{key:"activated",value:function(){document.querySelector("#date-item").classList.toggle("no-input-feet")}},{key:"namesPopover",value:function(e,t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return document.querySelector("#no-input-"+t).classList.toggle("no-input-feet"),n.next=3,this.popoverCtrl.create({component:v,cssClass:"sort-popover",event:e,mode:"md",translucent:!0});case 3:return(i=n.sent).onDidDismiss().then((function(e){void 0!==e.data&&(o.delivery[t].name=e.data.fromPopover),document.querySelector("#no-input-"+t).classList.toggle("no-input-feet")})),n.next=7,i.present();case 7:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"openOptionPopover",value:function(e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.popoverCtrl.create({component:y,event:e,mode:"md",translucent:!0});case 2:return(n=t.sent).onWillDismiss().then((function(e){i.type!=e.data.type&&i.init(),i.type=e.data.type})),t.next=6,n.present();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"setQuantite",value:function(e,t,n){for(var i=0,o=Object.keys(this.produits);i<o.length;i++){var r=o[i];this.produits[r].key==e&&(this.produits[r].content.stock=this.produits[r].content.stock+n*t,this.afDB.object("produits/"+e+"/stock").set(this.produits[r].content.stock))}}},{key:"save",value:function(){if(null!=this.key){for(var e=0,t=Object.keys(this.tmp);e<t.length;e++){var n=t[e];this.setQuantite(this.tmp[n].key,this.tmp[n].quantite,1)}this.modifyItemInFirebase()}else this.addItemToFirebase();for(var i=0,o=Object.keys(this.delivery);i<o.length;i++)for(var r=o[i],a=0,s=Object.keys(this.delivery[r].items);a<s.length;a++){var c=s[a];if(null!=this.delivery[r].items[c].formuleContent){if(0!=this.delivery[r].items[c].formuleContent.length)for(var l=0,b=Object.keys(this.delivery[r].items[c].formuleContent);l<b.length;l++){var u=b[l];this.setQuantite(this.delivery[r].items[c].formuleContent[u].key,this.delivery[r].items[c].formuleContent[u].quantite,-1)}}else""!=this.delivery[r].items[c].key&&this.setQuantite(this.delivery[r].items[c].key,this.delivery[r].items[c].quantite,-1)}this.close()}},{key:"addItemToFirebase",value:function(){this.afDB.list("Livraisons/").push({title:this.title,order:this.delivery,price:this.price,distance:this.km,date:this.date,clientName:this.clientName,type:this.type})}},{key:"modifyItemInFirebase",value:function(){this.afDB.object("Livraisons/"+this.key+"/title/").set(this.title),this.afDB.object("Livraisons/"+this.key+"/order/").set(this.delivery),this.afDB.object("Livraisons/"+this.key+"/price/").set(this.price),this.afDB.object("Livraisons/"+this.key+"/distance/").set(this.km),this.afDB.object("Livraisons/"+this.key+"/clientName/").set(this.clientName),this.afDB.object("Livraisons/"+this.key+"/date/").set(this.date),this.afDB.object("Livraisons/"+this.key+"/type/").set(this.type)}},{key:"getProduitsFromFirebase",value:function(){var e=this;this.afDB.list("produits/").snapshotChanges(["child_added","child_removed","child_changed"]).subscribe((function(t){e.produits=[],t.forEach((function(t){e.produits.push({key:t.key,content:t.payload.exportVal()})}))}))}}]),t}()).\u0275fac=function(e){return new(e||x)(a.Ib(s.W),a.Ib(s.ab),a.Ib(k.a))},x.\u0275cmp=a.Cb({type:x,selectors:[["app-new"]],inputs:{title:"title",key:"key",price:"price",km:"km",date:"date",clientName:"clientName",delivery:"delivery",type:"type"},decls:39,vars:13,consts:[[2,"--border-style","none"],["fill","clear","slot","start",3,"click"],["fill","clear","slot","end",3,"click"],[1,"content",3,"fullscreen"],[2,"margin-top","10px","z-index","0"],["size","large",2,"padding-left","0"],["slot","end","fill","clear",2,"--color","black",3,"click"],["name","chevron-down"],["lines","none"],[1,"full"],["type","text","required","","autocapitalize","on","autocorrect","on","placeholder","Titre",3,"ngModel","value","ngModelChange"],[1,"input-feet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["mode","ios",1,"full"],["type","number","enterkeyhint","done","inputmode","decimal","placeholder","Prix revente",3,"ngModel","value","ngModelChange"],["type","text","required","","autocapitalize","on","autocorrect","on","placeholder","Nom du client",3,"ngModel","value","ngModelChange"],["type","number","enterkeyhint","done","inputmode","decimal","placeholder","Km parcourut",3,"ngModel","value","ngModelChange"],[1,"input-feet","first-size"],["slot","end",2,"margin-right","0"],["id","date-item",1,"full"],["required","","display-timezone","utc",3,"ngModel","value","ionBlur","ngModelChange"],["slot","end","size","small","name","chevron-down",1,"focus-icon"],["mode","ios","required","",1,"full",3,"id","click"],[3,"click"],["name","add"],["type","number","enterkeyhint","done","inputmode","decimal","placeholder","Prix achat",3,"ngModel","value","ngModelChange"],["slide",""],["mode","ios",1,"full",3,"id"],["type","text","required","","autocapitalize","on","autocorrect","on",3,"ngModel","value","placeholder","ngModelChange"],[1,"input-feet","second-size"],["fill","clear","slot","end",1,"modal",3,"click"],["size","large","name","pricetag"],["side","end",2,"width","70px",3,"click"],["color","danger",2,"width","100%"],["name","trash",2,"position","absolute","top","25%","right","50%","transform","translate(50%, -50%)"],["mode","ios","lines","full",1,"full",3,"id"],["slot","end",2,"display","flex","margin","0","position","relative"],[2,"margin-right","20px","padding","7px",3,"click"],["size","small","name","remove",2,"margin","0"],[2,"position","absolute","left","50%","top","50%","transform","translate(-50%, -50%)"],[2,"margin-left","20px","padding","7px",3,"click"],["name","add",2,"margin","0"]],template:function(e,t){1&e&&(a.Lb(0,"ion-header"),a.Lb(1,"ion-toolbar",0),a.Lb(2,"ion-button",1),a.Tb("click",(function(){return t.close()})),a.Lb(3,"ion-label"),a.ic(4,"Annuler"),a.Kb(),a.Kb(),a.Lb(5,"ion-title"),a.ic(6,"Nouveau"),a.Kb(),a.Lb(7,"ion-button",2),a.Tb("click",(function(){return t.save()})),a.Lb(8,"ion-label"),a.ic(9,"Terminer"),a.Kb(),a.Kb(),a.Kb(),a.Kb(),a.Lb(10,"ion-content",3),a.Lb(11,"ion-toolbar",4),a.Lb(12,"ion-title",5),a.ic(13,"Livraison"),a.Kb(),a.Lb(14,"ion-button",6),a.Tb("click",(function(e){return t.openOptionPopover(e)})),a.Jb(15,"ion-icon",7),a.Kb(),a.Kb(),a.Lb(16,"ion-list",8),a.Lb(17,"ion-item",9),a.Lb(18,"ion-input",10),a.Tb("ngModelChange",(function(e){return t.title=e})),a.Kb(),a.Jb(19,"span",11),a.Kb(),a.hc(20,M,17,6,"ion-list",12),a.hc(21,O,5,0,"ion-item",13),a.Lb(22,"ion-item",14),a.Lb(23,"ion-input",15),a.Tb("ngModelChange",(function(e){return t.price=e})),a.Kb(),a.Jb(24,"span",11),a.Lb(25,"ion-label"),a.ic(26,"EUR"),a.Kb(),a.Kb(),a.Lb(27,"ion-item",14),a.Lb(28,"ion-input",16),a.Tb("ngModelChange",(function(e){return t.clientName=e})),a.Kb(),a.Jb(29,"span",11),a.Kb(),a.Lb(30,"ion-item",14),a.Lb(31,"ion-input",17),a.Tb("ngModelChange",(function(e){return t.km=e})),a.Kb(),a.Jb(32,"span",18),a.Lb(33,"ion-label",19),a.ic(34,"KM"),a.Kb(),a.Kb(),a.Lb(35,"ion-item",20),a.Lb(36,"ion-datetime",21),a.Tb("ionBlur",(function(){return t.activated()}))("ngModelChange",(function(e){return t.date=e})),a.Kb(),a.Jb(37,"span",11),a.Jb(38,"ion-icon",22),a.Kb(),a.Kb(),a.Kb()),2&e&&(a.yb(10),a.Yb("fullscreen",!0),a.yb(8),a.Yb("ngModel",t.title)("value",t.title),a.yb(2),a.Yb("ngForOf",t.delivery),a.yb(1),a.Yb("ngIf","share"==t.type),a.yb(2),a.Yb("ngModel",t.price)("value",t.price),a.yb(5),a.Yb("ngModel",t.clientName)("value",t.clientName),a.yb(3),a.Yb("ngModel",t.km)("value",t.km),a.yb(5),a.Yb("ngModel",t.date)("value",t.date))},directives:[s.q,s.T,s.e,s.z,s.R,s.l,s.r,s.A,s.t,s.s,s.db,C.f,C.d,C.e,c.h,c.i,s.Y,s.m,s.cb,s.k,s.C,s.y,s.x,s.w],styles:[".content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-top:10px;--padding-bottom:10px}.modal[_ngcontent-%COMP%]{--border-style:solid;--border-color:#000;--color:#000;--border-width:2px;height:45px}.focus-icon[_ngcontent-%COMP%]{margin-right:0}.item-has-focus[_ngcontent-%COMP%]   .input-feet[_ngcontent-%COMP%]{background:#3880ff;opacity:1}.item-has-focus[_ngcontent-%COMP%]   .focus-icon[_ngcontent-%COMP%]{color:#3880ff}.no-input-feet[_ngcontent-%COMP%]   .input-feet[_ngcontent-%COMP%]{background:#3880ff;opacity:1}.no-input-feet[_ngcontent-%COMP%]   .focus-icon[_ngcontent-%COMP%]{color:#3880ff}.input-feet[_ngcontent-%COMP%]{width:100%;height:2px;background:grey;opacity:.5;position:absolute;bottom:5px;transition-property:background,opacity;transition-duration:.2s}.first-size[_ngcontent-%COMP%]{width:85%}.second-size[_ngcontent-%COMP%]{width:75%}"]}),x)},"k+ul":function(t,i,o){"use strict";o.r(i),o.d(i,"Tab3PageModule",(function(){return T}));var r=o("TEn/"),a=o("tyNb"),s=o("ofXK"),c=o("3Pt+"),l=o("mrSG"),b=o("9ybx"),u=o("fXoL"),d=o("Sy1n"),m=o("sSZD");function p(e,t){1&e&&(u.Lb(0,"ion-title"),u.ic(1," Stonks "),u.Kb())}function f(e,t){1&e&&(u.Lb(0,"ion-title"),u.ic(1," Balence "),u.Kb())}function h(e,t){if(1&e&&(u.Lb(0,"ion-item"),u.Lb(1,"ion-label"),u.ic(2,"D\xe9partag\xe9e !"),u.Kb(),u.Jb(3,"ion-datetime",30),u.Kb()),2&e){var n=u.Vb().$implicit;u.yb(3),u.Zb("value",n.date)}}function g(e,t){if(1&e&&(u.Lb(0,"ion-list"),u.hc(1,h,4,1,"ion-item",1),u.Kb()),2&e){var n=t.$implicit,i=u.Vb().$implicit;u.yb(1),u.Yb("ngIf",n.last==i)}}function v(e,t){if(1&e){var n=u.Mb();u.Lb(0,"ion-list"),u.hc(1,g,2,1,"ion-list",14),u.Lb(2,"ion-item",26),u.Tb("click",(function(){u.ec(n);var e=t.$implicit;return u.Vb().goTo(e)})),u.Lb(3,"div",27),u.Lb(4,"ion-label"),u.ic(5),u.Kb(),u.Lb(6,"ion-note",28),u.ic(7," livr\xe9 par "),u.Lb(8,"strong"),u.ic(9),u.Kb(),u.Kb(),u.Kb(),u.Lb(10,"div",29),u.Lb(11,"ion-label"),u.ic(12),u.Kb(),u.Jb(13,"ion-datetime",30),u.Kb(),u.Kb(),u.Kb()}if(2&e){var i=t.$implicit,o=u.Vb();u.yb(1),u.Yb("ngForOf",o.sharing.reverse()),u.yb(4),u.kc(" ",i.title," "),u.yb(4),u.kc(" ",i.order[0].name," "),u.yb(3),u.kc(" \u20ac",(i.price-0).toFixed(2)," "),u.yb(1),u.Zb("value",i.date)}}function y(e,t){if(1&e&&(u.Lb(0,"ion-item"),u.Lb(1,"ion-label"),u.ic(2,"D\xe9partag\xe9e"),u.Kb(),u.Jb(3,"ion-icon",31),u.Jb(4,"ion-datetime",30),u.Kb()),2&e){var n=u.Vb();u.yb(4),u.Zb("value",n.sharing[0].date)}}function k(e,t){if(1&e&&(u.Lb(0,"ion-item",32),u.Lb(1,"div",33),u.Lb(2,"ion-label",34),u.ic(3),u.Kb(),u.Lb(4,"div",35),u.Jb(5,"ion-progress-bar",36),u.Lb(6,"ion-label"),u.ic(7),u.Kb(),u.Jb(8,"ion-progress-bar",37),u.Lb(9,"ion-label",38),u.ic(10),u.Kb(),u.Lb(11,"ion-note",39),u.ic(12,"Somme rapport\xe9"),u.Kb(),u.Lb(13,"ion-note",40),u.ic(14,"Somme gagn\xe9"),u.Kb(),u.Lb(15,"ion-note",41),u.ic(16),u.Kb(),u.Lb(17,"ion-note",42),u.ic(18),u.Kb(),u.Kb(),u.Kb(),u.Kb()),2&e){var n=t.$implicit,i=u.Vb();u.yb(3),u.kc(" ",n.name," "),u.yb(2),u.Zb("value",(i.getPourcent(n.tab.rapport,i.total)/100).toFixed(2)),u.yb(2),u.kc(" ",i.getPourcent(n.tab.rapport,i.total).toFixed(2),"% "),u.yb(1),u.Zb("value",(i.getPourcent(n.tab.total,i.total)/100).toFixed(2)),u.yb(2),u.kc(" ",i.getPourcent(n.tab.total,i.total).toFixed(2),"%"),u.yb(6),u.kc("\u20ac",n.tab.rapport.toFixed(2)," "),u.yb(2),u.kc("\u20ac",n.tab.total.toFixed(2)," ")}}function C(e,t){if(1&e){var n=u.Mb();u.Lb(0,"ion-fab",43),u.Lb(1,"ion-fab-button",44),u.Tb("click",(function(){return u.ec(n),u.Vb().addNewExpModal()})),u.Jb(2,"ion-icon",45),u.Kb(),u.Kb()}}function L(e,t){if(1&e&&(u.Lb(0,"ion-toolbar",46),u.Lb(1,"div",47),u.Lb(2,"ion-note",48),u.ic(3,"MY TOTAL"),u.Kb(),u.Jb(4,"br"),u.Lb(5,"ion-label",49),u.ic(6,"\u20ac -- . --"),u.Kb(),u.Kb(),u.Lb(7,"div",50),u.Lb(8,"ion-note",48),u.ic(9,"TOTAL STONKS"),u.Kb(),u.Jb(10,"br"),u.Lb(11,"ion-label",49),u.ic(12),u.Kb(),u.Kb(),u.Kb()),2&e){var n=u.Vb();u.yb(12),u.kc("\u20ac",n.total.toFixed(2),"")}}function K(e,t){if(1&e){var n=u.Mb();u.Lb(0,"ion-button",51),u.Tb("click",(function(){return u.ec(n),u.Vb().confirmAlert()})),u.Lb(1,"ion-label"),u.ic(2,"D\xe9partager"),u.Kb(),u.Kb()}}var P,M,O,x=((P=function(){function t(n,i,o,r,a,s){e(this,t),this.modalController=n,this.app=i,this.afDB=o,this.alertCtrl=r,this.navCtrl=a,this.popoverCtrl=s,this.pageName=!0,this.date=(new Date).toISOString(),this.items=[],this.sharing=[],this.total=0,this.charges=0,this.benef=0,this.admin=[{name:"Hugo",tab:{total:0,rapport:0}},{name:"Alexis",tab:{total:0,rapport:0}},{name:"Taheir",tab:{total:0,rapport:0}},{name:"Marvyn",tab:{total:0,rapport:0}},{name:"Gud",tab:{total:0,rapport:0}}],this.segment=0,this.slidesOptions={initialSlide:0,slidesPerView:1,speed:400},this.afDB=this.app.afDB,this.getStonksInFirebase(),this.getSharingFromFirebase()}return n(t,[{key:"segmentChanged",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectedSlide.slideTo(this.segment);case 2:this.pageName=0!=this.segment;case 3:case"end":return e.stop()}}),e,this)})))}},{key:"slideChanged",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.selectedSlide=e,e.getActiveIndex().then((function(e){n.segment=e,0==n.segment?n.pageName=!1:1==n.segment&&(n.pageName=!0)}));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"showBenef",value:function(){document.querySelector("#benef").classList.toggle("open")}},{key:"addNewExpModal",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:b.a,componentProps:{afDB:this.afDB},cssClass:"my-custom-class"});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"goTo",value:function(e){this.navCtrl.navigateForward("/tabs/tab3/edit",{queryParams:{item:e}})}},{key:"confirmAlert",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertCtrl.create({cssClass:"my-custom-class",header:"Confirmer",message:"Voulez-vous vraiment r\xe9partir le montant total avec tout le monde ?",buttons:[{text:"Annuler",role:"Cancel"},{text:"Confirmer",handler:function(){for(var e=0,t=Object.keys(n.items);e<t.length;e++){var i=t[e];n.afDB.object("Livraisons/"+n.items[i].key+"/sharing/").set(!0)}n.afDB.list("sharing").push({date:(new Date).toISOString(),last:n.items[n.items.length-1]})}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getFuelPrice",value:function(e){var t=2;return e>15?t+=1*(e-15)/7:0==e&&(t=0),t}},{key:"getPourcent",value:function(e,t){return 0==t&&(t=1),e/t*100}},{key:"getStonksInFirebase",value:function(){var e=this;this.afDB.list("Livraisons/").snapshotChanges(["child_added","child_removed","child_changed"]).subscribe((function(t){e.items=[],e.total=0,e.charges=0;for(var n=0,i=Object.keys(e.admin);n<i.length;n++){var o=i[n];e.admin[o].tab.rapport=0,e.admin[o].tab.total=0}t.forEach((function(t){var n=t.payload.exportVal();if(null==n.sharing){e.total=e.total+ +n.price;for(var i=0,o=Object.keys(e.admin);i<o.length;i++)for(var r=o[i],a=0,s=Object.keys(n.order);a<s.length;a++){var c=s[a];if(e.admin[r].name==n.order[c].name){n.order[c]==n.order[0]&&(e.admin[r].tab.rapport=e.admin[r].tab.rapport+ +n.price);var l=0;e.admin[r].name==n.order[0].name&&(console.log(e.admin),l=e.getFuelPrice(+n.order[c].distance)),e.admin[r].tab.total=e.admin[r].tab.total+ +n.order[c].firstPrice+l,e.charges=e.charges+ +n.order[c].firstPrice+l}}}null==n.old&&e.items.push({key:t.key,order:n.order,title:n.title,price:n.price,date:n.date,km:n.distance,clientName:n.clientName,type:n.type,sharing:n.sharing})}));for(var r=0,a=Object.keys(e.admin);r<a.length;r++){var s=a[r];e.admin[s].tab.total=e.admin[s].tab.total+(e.total-e.charges)/5}e.benef=e.total-e.charges}))}},{key:"getSharingFromFirebase",value:function(){var e=this;this.afDB.list("sharings/").snapshotChanges(["child_added","child_changed","child_removed"]).subscribe((function(t){e.sharing=[],t.forEach((function(t){e.sharing.push({date:t.payload.exportVal().date,last:t.payload.exportVal().last})}))}))}}]),t}()).\u0275fac=function(e){return new(e||P)(u.Ib(r.W),u.Ib(d.a),u.Ib(m.a),u.Ib(r.a),u.Ib(r.X),u.Ib(r.ab))},P.\u0275cmp=u.Cb({type:P,selectors:[["app-tab3"]],decls:37,vars:14,consts:[["mode","ios",3,"translucent"],[4,"ngIf"],["slot","end","fill","clear",1,"toolbar-button"],["name","reader"],["id","stats-content","color","light",3,"fullscreen"],[3,"ngModel","ngModelChange","ionChange"],["value","0"],["name","receipt"],["value","1"],["name","swap-horizontal"],["id","content",3,"options","ionSlideDidChange","ionSlidesDidLoad"],["slides",""],["id","Stonks-page"],["lines","full"],[4,"ngFor","ngForOf"],["color","light  ","lines","none"],["id","balence-page"],["mode","md","button","","lines","none",2,"height","50px",3,"click"],["size","large",2,"text-align","center"],["id","benef","lines","none"],[2,"text-align","center"],["button","","detail","false","color","light",4,"ngFor","ngForOf"],["id","bottom-item"],["id","tricount-add","vertical","bottom","horizontal","center",4,"ngIf"],["id","tricount-toolbar",4,"ngIf"],["color","light","expand","full",3,"click",4,"ngIf"],["button","","detail","false","routerDirection","forward",3,"click"],["slot","start",2,"width","60%"],["slot","end",2,"font-size","12pt"],["slot","end",2,"text-align","right","margin-left","0"],["disabled","","displayFormat","MM/DD/YYYY",3,"value"],["name","checkmark","slot","start"],["button","","detail","false","color","light"],[1,"item-content"],[1,"label"],[1,"progress-bar"],["slot","start","color","warning","reversed","true",3,"value"],[1,"right",2,"position","absolute",3,"value"],[1,"right"],[1,"up"],[1,"right","up"],[1,"down"],[1,"right","down"],["id","tricount-add","vertical","bottom","horizontal","center"],[3,"click"],["name","add"],["id","tricount-toolbar"],["slot","start",2,"text-align","left"],[2,"font-size","small"],[2,"font-size","small","font-weight","bold"],["slot","end"],["color","light","expand","full",3,"click"]],template:function(e,t){if(1&e){var n=u.Mb();u.Lb(0,"ion-header",0),u.Lb(1,"ion-toolbar"),u.hc(2,p,2,0,"ion-title",1),u.hc(3,f,2,0,"ion-title",1),u.Lb(4,"ion-button",2),u.Jb(5,"ion-icon",3),u.Kb(),u.Kb(),u.Kb(),u.Lb(6,"ion-content",4),u.Lb(7,"ion-segment",5),u.Tb("ngModelChange",(function(e){return t.segment=e}))("ionChange",(function(e){return t.segmentChanged(e)})),u.Lb(8,"ion-segment-button",6),u.Jb(9,"ion-icon",7),u.Lb(10,"ion-label"),u.ic(11,"Stonks"),u.Kb(),u.Kb(),u.Lb(12,"ion-segment-button",8),u.Jb(13,"ion-icon",9),u.Lb(14,"ion-label"),u.ic(15,"Balence"),u.Kb(),u.Kb(),u.Kb(),u.Lb(16,"ion-slides",10,11),u.Tb("ionSlideDidChange",(function(){u.ec(n);var e=u.dc(17);return t.slideChanged(e)}))("ionSlidesDidLoad",(function(){u.ec(n);var e=u.dc(17);return t.slideChanged(e)})),u.Lb(18,"ion-slide",12),u.Lb(19,"ion-list",13),u.hc(20,v,14,5,"ion-list",14),u.hc(21,y,5,1,"ion-item",1),u.Jb(22,"ion-item",15),u.Kb(),u.Kb(),u.Lb(23,"ion-slide",16),u.Lb(24,"ion-list",13),u.Lb(25,"ion-item",17),u.Tb("click",(function(){return t.showBenef()})),u.Lb(26,"ion-title",18),u.ic(27),u.Kb(),u.Kb(),u.Lb(28,"ion-item",19),u.Lb(29,"ion-title",20),u.ic(30),u.Kb(),u.Kb(),u.hc(31,k,19,7,"ion-item",21),u.Jb(32,"ion-item-divider",22),u.Kb(),u.Kb(),u.Kb(),u.Kb(),u.hc(33,C,3,0,"ion-fab",23),u.Lb(34,"ion-footer"),u.hc(35,L,13,1,"ion-toolbar",24),u.hc(36,K,3,0,"ion-button",25),u.Kb()}2&e&&(u.Yb("translucent",!0),u.yb(2),u.Yb("ngIf",!t.pageName),u.yb(1),u.Yb("ngIf",t.pageName),u.yb(3),u.Yb("fullscreen",!0),u.yb(1),u.Yb("ngModel",t.segment),u.yb(9),u.Yb("options",t.slidesOptions),u.yb(4),u.Yb("ngForOf",t.items.reverse()),u.yb(1),u.Yb("ngIf",null!=t.sharing[0]),u.yb(6),u.kc(" Total : \u20ac",t.total.toFixed(2)," "),u.yb(3),u.kc(" B\xe9n\xe9fice : \u20ac",t.benef.toFixed(2)," "),u.yb(1),u.Yb("ngForOf",t.admin),u.yb(2),u.Yb("ngIf",!t.pageName),u.yb(2),u.Yb("ngIf",!t.pageName),u.yb(1),u.Yb("ngIf",t.pageName))},directives:[r.q,r.T,s.i,r.e,r.r,r.l,r.K,r.cb,c.d,c.e,r.L,r.z,r.N,r.M,r.A,s.h,r.t,r.R,r.u,r.p,r.C,r.m,r.D,r.n,r.o],styles:[".small-margin[_ngcontent-%COMP%]{margin:10px}.toolbar-button[_ngcontent-%COMP%]{--color:#000;margin:0 10px;--padding-start:0;--padding-end:0}ion-content[_ngcontent-%COMP%]{--overflow:hidden}ion-slide[_ngcontent-%COMP%]{overflow:scroll}#content[_ngcontent-%COMP%]{height:100%}#content[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%]{display:block}#Stonks-page[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-top:5px;--padding-bottom:5px}#Stonks-page[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-bottom:5px}#Stonks-page[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%]{font-size:small;--padding-end:0;--padding-start:0;--padding-top:0;--padding-bottom:0}#balence-page[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start:0;--pading-end:0}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]{width:100%;padding:10px 0}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:15px}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{text-align:center;font-weight:700}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{display:flex;width:100%;padding-bottom:20px}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   ion-progress-bar[_ngcontent-%COMP%]{width:50%;height:20px}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{position:absolute;bottom:15px}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:small;position:absolute;margin:5px}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .up[_ngcontent-%COMP%]{bottom:55px}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .down[_ngcontent-%COMP%]{bottom:0}#balence-page[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{right:0}#balence-page[_ngcontent-%COMP%]   #bottom-item[_ngcontent-%COMP%]{--background:#fff}.ios[_ngcontent-%COMP%]   #bottom-item[_ngcontent-%COMP%]{height:50px}.md[_ngcontent-%COMP%]   #bottom-item[_ngcontent-%COMP%]{height:65px}#benef[_ngcontent-%COMP%]{height:0;transition-property:height;transition-duration:.2s}.open[_ngcontent-%COMP%]{height:50px!important}"]}),P),_=o("qtYk"),w=[{path:"",component:x},{path:"edit",loadChildren:function(){return o.e(16).then(o.bind(null,"xhSr")).then((function(e){return e.EditPageModule}))}}],F=((O=function t(){e(this,t)}).\u0275mod=u.Gb({type:O}),O.\u0275inj=u.Fb({factory:function(e){return new(e||O)},imports:[[a.i.forChild(w)]]}),O),T=((M=function t(){e(this,t)}).\u0275mod=u.Gb({type:M}),M.\u0275inj=u.Fb({factory:function(e){return new(e||M)},imports:[[r.U,s.b,c.a,_.a,a.i.forChild([{path:"",component:x}]),F]]}),M)}}])}();