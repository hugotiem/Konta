{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{xhSr:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"EditPageModule\",(function(){return edit_module_EditPageModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),ionic_angular=__webpack_require__(\"TEn/\"),router=__webpack_require__(\"tyNb\"),tslib_es6=__webpack_require__(\"mrSG\"),new_component=__webpack_require__(\"9ybx\"),core=__webpack_require__(\"fXoL\"),angular_fire_database=__webpack_require__(\"sSZD\");function EditPage_ion_item_31_Template(rf,ctx){if(1&rf&&(core.Lb(0,\"ion-item\",10),core.Lb(1,\"ion-label\"),core.ic(2,\"Nom du client :\"),core.Kb(),core.Lb(3,\"ion-note\",11),core.ic(4),core.Kb(),core.Kb()),2&rf){const ctx_r0=core.Vb();core.yb(4),core.kc(\" \",ctx_r0.item.clientName,\" \")}}const routes=[{path:\"\",component:(()=>{class EditPage{constructor(navCtrl,modalController,afDB,route){this.navCtrl=navCtrl,this.modalController=modalController,this.afDB=afDB,this.route=route,this.item=[],this.produits=[],this.details=\"\",this.route.queryParams.subscribe(params=>{this.key=params.item.key})}ngOnInit(){this.getDeliveryFromFirebase(),this.getProduitsFromFirebase()}goBack(){this.navCtrl.navigateBack(\"tabs/tab3\")}getType(type){return\"lone\"==type?\"Livraison seule\":\"Livraison partagée\"}addNewExpModal(){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){const modal=yield this.modalController.create({component:new_component.a,componentProps:{afDB:this.afDB,key:this.key,delivery:this.item.order,title:this.item.title,price:this.item.price,date:this.item.date,km:this.item.distance,type:this.item.type,clientName:this.item.clientName},cssClass:\"my-custom-class\"});return yield modal.present()}))}setQuantite(key,val){for(let p of Object.keys(this.produits))this.produits[p].key==key&&(this.produits[p].content.stock=this.produits[p].content.stock+val,this.afDB.object(\"produits/\"+key+\"/stock\").set(this.produits[p].content.stock))}delete(){for(let admin of Object.keys(this.item.order))for(let i of Object.keys(this.item.order[admin].items))if(null!=this.item.order[admin].items[i].formuleContent){if(0!=this.item.order[admin].items[i].formuleContent.length)for(let p of Object.keys(this.item.order[admin].items[i].formuleContent))this.setQuantite(this.item.order[admin].items[i].formuleContent[p].key,this.item.order[admin].items[i].formuleContent[p].quantite)}else\"\"!=this.item.order[admin].items[i].key&&this.setQuantite(this.item.order[admin].items[i].key,this.item.order[admin].items[i].quantite);this.afDB.list(\"Livraisons/\").remove(this.key),this.goBack()}getDeliveryFromFirebase(){this.afDB.object(\"Livraisons/\"+this.key).valueChanges().subscribe(item=>{this.item=item})}getProduitsFromFirebase(){this.afDB.list(\"produits\").snapshotChanges([\"child_added\",\"child_removed\",\"child_changed\"]).subscribe(actions=>{this.produits=[],this.details=\"\",actions.forEach(action=>{this.produits.push({key:action.key,content:action.payload.exportVal()})});for(let admin of Object.keys(this.item.order))for(let i of Object.keys(this.item.order[admin].items))this.details=this.item.order[admin]==this.item.order[0]&&this.item.order[admin].items[i]==this.item.order[0].items[0]?this.item.order[admin].items[i].quantite+\" x \"+this.item.order[admin].items[i].title:this.details+\", \"+this.item.order[admin].items[i].quantite+\" x \"+this.item.order[admin].items[i].title})}}return EditPage.ɵfac=function(t){return new(t||EditPage)(core.Ib(ionic_angular.V),core.Ib(ionic_angular.U),core.Ib(angular_fire_database.a),core.Ib(router.a))},EditPage.ɵcmp=core.Cb({type:EditPage,selectors:[[\"app-edit\"]],decls:43,vars:8,consts:[[1,\"ion-no-border\"],[2,\"--border-style\",\"none\"],[\"slot\",\"start\",\"fill\",\"clear\",1,\"toolbar-button\",2,\"--padding-start\",\"0\",3,\"click\"],[\"size\",\"large\",\"name\",\"chevron-back\"],[\"slot\",\"end\",\"fill\",\"clear\",1,\"toolbar-button\",3,\"click\"],[\"lines\",\"none\"],[2,\"text-align\",\"center\"],[2,\"font-size\",\"20pt\",\"font-weight\",\"bold\"],[2,\"--padding-end\",\"0\"],[\"slot\",\"end\",\"readonly\",\"\",\"displayFormat\",\"DD/MM/YYYY\",2,\"text-align\",\"end\",3,\"value\"],[\"lines\",\"full\"],[\"slot\",\"end\",2,\"text-align\",\"right\"],[\"lines\",\"full\",4,\"ngIf\"],[\"lines\",\"full\",\"fill\",\"clear\",\"expand\",\"full\",3,\"click\"],[\"color\",\"danger\"]],template:function(rf,ctx){1&rf&&(core.Lb(0,\"ion-header\",0),core.Lb(1,\"ion-toolbar\",1),core.Lb(2,\"ion-button\",2),core.Tb(\"click\",(function(){return ctx.goBack()})),core.Jb(3,\"ion-icon\",3),core.Kb(),core.Lb(4,\"ion-button\",4),core.Tb(\"click\",(function(){return ctx.addNewExpModal()})),core.Lb(5,\"ion-label\"),core.ic(6,\"Edit\"),core.Kb(),core.Kb(),core.Kb(),core.Lb(7,\"ion-list\",5),core.Lb(8,\"ion-item\",6),core.Lb(9,\"ion-label\",7),core.ic(10),core.Kb(),core.Kb(),core.Lb(11,\"ion-item\"),core.Lb(12,\"ion-title\"),core.ic(13),core.Kb(),core.Kb(),core.Lb(14,\"ion-item\",8),core.Lb(15,\"ion-label\"),core.ic(16,\"Livré par \"),core.Lb(17,\"strong\"),core.ic(18),core.Kb(),core.Kb(),core.Jb(19,\"ion-datetime\",9),core.Kb(),core.Jb(20,\"ion-item-divider\",10),core.Lb(21,\"ion-item\",10),core.Lb(22,\"ion-label\"),core.ic(23,\"Détail :\"),core.Kb(),core.Lb(24,\"ion-note\",11),core.ic(25),core.Kb(),core.Kb(),core.Lb(26,\"ion-item\",10),core.Lb(27,\"ion-label\"),core.ic(28,\"Distance :\"),core.Kb(),core.Lb(29,\"ion-note\",11),core.ic(30),core.Kb(),core.Kb(),core.hc(31,EditPage_ion_item_31_Template,5,1,\"ion-item\",12),core.Lb(32,\"ion-item\"),core.Lb(33,\"ion-label\"),core.ic(34,\"Type de livraison :\"),core.Kb(),core.Lb(35,\"ion-note\",11),core.ic(36),core.Kb(),core.Kb(),core.Jb(37,\"ion-item-divider\"),core.Lb(38,\"section\"),core.Lb(39,\"ion-button\",13),core.Tb(\"click\",(function(){return ctx.delete()})),core.Lb(40,\"ion-label\",14),core.ic(41,\"Supprimer item\"),core.Kb(),core.Kb(),core.Kb(),core.Kb(),core.Kb(),core.Jb(42,\"ion-content\")),2&rf&&(core.yb(10),core.kc(\" \",ctx.item.title,\" \"),core.yb(3),core.kc(\"€\",(ctx.item.price-0).toFixed(2),\" \"),core.yb(5),core.jc(ctx.item.name),core.yb(1),core.Zb(\"value\",ctx.item.date),core.yb(6),core.kc(\" \",ctx.details,\" \"),core.yb(5),core.kc(\" \",ctx.item.distance,\" km \"),core.yb(1),core.Yb(\"ngIf\",\"prodOnly\"!=ctx.item.type),core.yb(5),core.kc(\" \",ctx.getType(ctx.item.type),\" \"))},directives:[ionic_angular.q,ionic_angular.R,ionic_angular.e,ionic_angular.r,ionic_angular.z,ionic_angular.A,ionic_angular.t,ionic_angular.P,ionic_angular.m,ionic_angular.ab,ionic_angular.u,ionic_angular.C,common.i,ionic_angular.l],styles:[\"ion-item.ion-activated[_ngcontent-%COMP%]{--background-activated:none}\"]}),EditPage})()}];let edit_routing_module_EditPageRoutingModule=(()=>{class EditPageRoutingModule{}return EditPageRoutingModule.ɵmod=core.Gb({type:EditPageRoutingModule}),EditPageRoutingModule.ɵinj=core.Fb({factory:function(t){return new(t||EditPageRoutingModule)},imports:[[router.i.forChild(routes)],router.i]}),EditPageRoutingModule})(),edit_module_EditPageModule=(()=>{class EditPageModule{}return EditPageModule.ɵmod=core.Gb({type:EditPageModule}),EditPageModule.ɵinj=core.Fb({factory:function(t){return new(t||EditPageModule)},imports:[[common.b,fesm2015_forms.a,ionic_angular.S,edit_routing_module_EditPageRoutingModule]]}),EditPageModule})()}}]);","extractedComments":[]}